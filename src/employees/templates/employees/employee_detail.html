{% extends "content.html" %}
{% load static %}
{% load workify_tags %}

{% block main %}
<div class="container">
    <div class="row">
        <div class="col-lg">
            {% if employee.avatar %}
            <img src="{{ employee.avatar.url }}" alt="" class="img-thumbnail">
            {% endif %}
        </div>
        <div class="col-lg">
            <div class="row">
                <div class="col">First name:</div>
                <div class="col">{{ employee.user.first_name}}</div>
            </div>
            <div class="row">
                <div class="col">Last name:</div>
                <div class="col">{{ employee.user.last_name}}</div>
            </div>
            <div class="row">
                <div class="col">Email:</div>
                <div class="col"><a href="mailto:{{ employee.user.email}}">{{ employee.user.email}}</a></div>
            </div>
            <div class="row">
                <div class="col">Tax ID:</div>
                <div class="col">{{ employee.tax_id}}</div>
            </div>
            <div class="row">
                <div class="col">Groups:</div>
                <div class="col">
                    {% for group in employee.user.groups.all %}
                    <span class="badge bg-primary">{{ group }}</span>
                    {% endfor %}
                </div>
            </div>
            <div class="row">
                <div class="col">Documents:</div>
                <div class="col"><a href="#documents_section" >[{{ employee.employeedocument_set.count }}]</a></div>
            </div>
            <div class="row">
                <div class="col">Rates:</div>
                <div class="col">[todo] Rates count and link</div>
            </div>
            <div class="row">
                <div class="col">Time reports:</div>
                <div class="col">[todo] TR count and link</div>
            </div>
        </div>
    </div>
</div>
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom" id="documents_section">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb h2">
        Documents
      </ol>
    </nav>          
    
    <div class="btn-toolbar mb-2 mb-md-0">
      {% link_button employee.get_new_document_url 'success' 'Add document' 'plus'  %}
    </div>
</div>
<table class="table table-striped align-middle table-hover">
    <thead>
        <tr>
            <th scope="col" >#</th>
            <th scope="col" >Name</th>
            <th scope="col" >Signature day</th>
            <th scope="col" >Type</th>
            <th scope="col" >Reference</th>
            <th scope="col" ></th>
        </tr>
    </thead>
    <tbody>
        {% for document in employee.employeedocument_set.all %}
        <tr scope="row">
            <td>{{forloop.counter}}</td>
            <td>{{ document.name }}</td>
            <td>{{ document.sign_date }}</td>
            <td>{{ document.get_document_type_display }}</td>
            <td>
                {% if document.reference_document %}
                <a href="{{document.reference_document.document_file.url}}">{{ document.reference_document }}</a> 
                <a href="{{document.reference_document.document_file.url}}"><span data-feather="external-link"></span></a> 
                {% endif %}
            </td>
            <td>                
                <div class="btn-toolbar d-flex justify-content-end" role="toolbar">
                    {% link_button document.document_file.url 'primary' 'open' 'external-link' '_blank' %}
                    {% link_button document.get_update_url 'success' 'edit' 'edit' %}
                    {% popup_button document.get_delete_url 'danger' 'delete' 'trash-2' %}
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}